\chapter{МРС}\label{chap3}



\section{МРС}\label{mpcu}
Рассмотрим объект, поведение которого $x$ зависимого от  $t$ описывается нелинейным дифференциальным уравнением:
$$\dot{x}(s)=f(s,x(s),u(s)), s\geq t,$$
\begin{equation}\label{exg}
x(t)=x_t
\end{equation}

$$u(s) \in U(s).$$

Данные этой модели состоят из:
\begin{itemize}
\item набора $ X_0 \subset \R^n$ содержащий все возможные начальные состояния в начальный момент времени $t_0$,
\item вектор $x_t$ (для $t \geq t_0$ ), который описывает состояние объекта и определяется в момент времени $t$ функцией $f$: $\R \times \R^n \times \R^m \rightarrow \R^n$,
\item допустимого множества управлений $U$:$\R \rightrightarrows\R^m$
    \end{itemize}
Эти данные в сочетании с функцией управления $u$:$ [t,+\infty)\rightarrow \R^m$ определим траекторию $x$: $ [t,+\infty)\rightarrow \R^n$.
Предположим, что эта система асимптотически устойчива на $X_0$.

Для нахождения состояние нашего объекта, необходимо получить управление обратной связи. Эта задача решается с использованием стратегии MPC.
Рассмотрим последовательность моментов выборки ${t_i }_{i\geq 0}$ с постоянным временем выборки $ \delta > 0$ (меньше чем горизонт $T$) таким, что $t_{i + 1} = t_i + \delta$ для всех $i \geq 0$. Управление обратной связи получается путем решение задачи оптимального управления в текущий момент времени $P (t_i , x_{t_i} ,T)$ в каждый момент выборки $t_i$, используя текущего показателя состояния объекта $x_{t_i}$.
Задача:
\begin{equation}\label{ppp} P (t_i , x_{t_i} ,T)=\int^{t+T}_t L(s,x(s),u(s))ds + W(t+T,x(t+T))
\end{equation},
при условии:
$$\dot{x}(s)=f(s,x(s),u(s)), s\geq [t,t+T],$$
$$x(t)=x_t$$
$$u(s) \in U(s).$$
$$x(t+T) \in S$$.

Решение этой задачи оптимизации является множество допустимых процессов, а именно пары $(x, u)$, содержащие измеримую функцию управления $u$ и непрерывную траекторию состояния $x$, которые удовлетворяют ограничениям $P (t_i , x_{t_i} ,T)$. Задача считается решаемой если существует хотя бы один допустимое решение. Пара $(\bar{x}, \bar{u})$ называется решением $P (t_i , x_{t_i} ,T)$, если он глобально минимизирует (\ref{ppp}) среди всех пар.

Переменная $t$ обозначает текущий момент времени, в то время как $s$ используется для обозначения переменной времени в модели прогнозирования. Вектор $x_t$ обозначает фактическое состояние объекта, в момент времени $t$. Процесс $(x, u)$ представляет собой пару траектория / управление полученные из решения системы. Траектория иногда обозначается как $s \mapsto x(s;t,x_t,u)$, когда мы хотим показать явную зависимость времени, начального состояние и функции управления. Пара$(\bar{x}, \bar{u})$ обозначает наше оптимальное решение для разомкнутого контура, задача оптимального управления (OCP). Процесс $(x^* , u^* )$ является замкнутым контуром траектории и управления в результате из стратегии MPC.

не знаю как перевести след предложение
We call design parameters
the variables present in the open-loop optimal control
problem that are not from the system model (i.e. variables we are able to choose); these comprise the time
horizon $T$, the running and terminal costs functions
$L$ and $W$, and the terminal constraint set $S \subset \R^n$

Алгоритм MPC заключается в выполнении следующих шагов в определенный момент времени $t_i$:
\begin{enumerate}
  \item Измерение текущее состояние объекта $x_{t_i}$.
  \item Вычислить оптимальное управление обратной связи $\bar{u}$: $[t_i , t_{i + T}] \rightarrow \R^n$ решение задачи $P (t_i , x_{t_i} ,T)$.
  \item  Управление $u^* (t): = \bar{u} (t)$ на интервале$[t_i , t_{i}+\delta]$ применяется к объекту, (оставшийся управление $\bar{u} (t)$, $t \geq t_i + \delta$ отбрасывается).
  \item Процедура повторяется из (1.) для следующего момента выборки $t_{i + 1}$ (индекс $i$ увеличивается на одну единицу).
\end{enumerate}

Результирующий закон управления является управлением обратной связи, так как в течение каждого интервала выборки управление $u^*$ определяется от состояния $x_{t_i}$.

Это общеизвестный факт (для фиксированного конечного горизонта)замкнутая траектория системы $(x^*)$ не обязательно совпадают с траекторией разомкнутого контура $(\bar{x})$ решение OCP. Отсюда тот факт, что MPC приведет к стабилизации замкнутой системы негарантированно и сильно зависит от design parameters стратегии MPC.

Можно гарантировать стабильность результата замкнутой системы, выбирая design parameters, удовлетворяющие определенному условию устойчивости. Важнейшим элементом условия устойчивости является требование, чтобы design parameters были выбраны в такими, что для всех состояний $х$, принадлежащих множеству возможных конечных состояний OCP (то есть, подмножество $S$), существует управление значение $\tilde{u}$ такой, что
\begin{equation}\label{www1}
  W_x (x) \cdot f (t, x, \tilde{u}) ? ?L (t, x, \tilde{u})
\end{equation}.


Это условие важно для определения того, что некоторая функция $V^{\delta}$, построенная из функций значения вовлеченных OCPs «уменьшается». Затем, используя аргументы типа Ляпунова, для доказательства устойчивость замкнутой системы. Определили, что если $W$ - контрольная функция Ляпунова (следовательно, удовлетворяющая условие (\ref{www1}) для $S = \R^n$ ), тогда стабильность может быть достигнуты. Здесь мы также показываем, как стабильность других MPC схемы можно проверить с помощью (\ref{www1}). Важным следствием является то, что это обобщение позволяет нам строить схемы MPC гарантируя стабильность для новых важных классов нелинейных систем.
Гипотезы:

H1: Для всех $t\in \R^n$ множество $U (t)$ содержит начало координат,и $f (t, 0, 0) = 0$.

H2: Функция $f$ непрерывна, и $x \mapsto f (t, x, u)$локально липшицева непрерывна для каждой пары $(t, u)$.

H3: Множество $U (t)$ компактно для всех $t$ и для каждой пары $(t, x)$ множество $f (t, x, U (t))$ выпукло.

H4: Функция $f$ компактна на компакте $x$ точнее, для любого компакта $X \subset \R^n$ ,множество ${f (t, x, u): t \in \R, x \in X, u \in U (t)}$ компакт.

Гипотеза H1 не должна рассматриваться как ограничительная,так как большинство систем может быть сделано, чтобы удовлетворить его после соответствующее изменение координат. Предположение H3 (вместе с H2) необходимо чтобы гарантировать существование решения OCP. Условие в H4 автоматически выполняется для инвариантных по времени системы, так как образ компактного множества под непрерывную функцию компактны.

Основной результат стабильности утверждает, что контроллер обратной связи в результате применение стратегии MPC является стабилизирующим контроллер, при условии, что проектные параметры удовлетворяют условие устойчивости ниже. Рассмотрим следующее условие устойчивости СЦ:
SC Для системы (\ref{exg}) design parameters: горизонт планирования $T$, целевые функции $L$ и $W$ и терминальное множество ограничений $S$ удовлетворяет:

SC1 Множество $S$ замкнуто и содержит начало координат.

SC2 Функция $L$ непрерывна, $L (\cdot, 0, 0) = 0$,и есть непрерывное положительно определенное неограниченная функция $M$: $\R^n \rightarrow \R_+$ такая что $L (t, x, u) \geq M (x)$ для всех $(t, u) \in \R \times \R^m$ . Более того, «расширенное множество скоростей»{$(v, l) \in \R^n \times \R_+$ $: v = f (t, x, u)$, $l \geq L (t, x, u)$, $u \in U (t)$} является выпуклым для всех $(t, x)$.

SC3 Функция $W$ положительно полуопределена и непрерывно дифференцируема.

SC4 Временной горизонт $T$ таков, что множество $S$ достижимо за время $T$ из любого начального состояния и из любой точки в сгенерированных траекториях: что есть множество $X$, содержащее $X_0$ такое, что для каждой пары $(t_0 , x_0 ) \in \R \times X$ существует управление $u: [t_0 , t_0 + T] \rightarrow \R^m$, удовлетворяющие 
$$x (t_0 + T; t_0 , x_0 , u) \in S$$.

Кроме того, для всех функций управления и в условиях над $$x (t; t_0 , x_0 , u) \in X$$
 для всех $t \in [t_0 , t_0 + T].$
 
 SC5 Существует скаляр $\epsilon > 0$ такой, что для каждого времени $t \in [T, \inf)$ и каждого $x_t \in S$, мы можем выбрать функцию управления $\tilde{u}: [t, t + \epsilon] \rightarrow \R^m$ , причем $\tilde{u} (s) \in U (s)$ для всех $s \in [t, t + \epsilon]$, удовлетворяющих
 $$W_t (t, x_t ) + W_x (t, x_t )\cdot f (t, x_t , \tilde{u} (t))\leq ?L (t, x_t , \tilde{u} (t))$$(SC5a)
 
 а также
 $$х (t + r; t, x_t , \tilde{u}) \in S$$(SC5b) для всех $r \in [0, \epsilon]$.
 
Предложение. Предположим, гипотезы H1 – H4. Предположим также, что design parameters удовлетворяют SC. Тогда для любое $(t_0 , x_0 ) \in \R \times X_0$ решение открытого цикла существует задача оптимального управления $P (t_0 , x$0 , T).

Рассмотрим последовательность пар ${t_i , x_i} $такую, что $x_i$ - значение в момент времени $t_i$ решения траектории $P (t_{i ? 1} , x_{i ? 1} , T)$. Тогда решение $P (t_i , x_i , T)$ для всех $i \geq 1$ также существует. Кроме того, построенная MPC траектория $x^*$ имеет конечных временной интервал.

Основной результат по устойчивости заключается в следующем.

Теорема. Предположим, что система удовлетворяет гипотезам H1-H4. Выберите design parameters, чтобы удовлетворить SC, Тогда для достаточно малого времени между выборками $\delta$,система с обратной связью в результате применения стратегии MPC асимптотически устойчив $ \parallel x^* (t)\parallel \rightarrow 0$ при $t \rightarrow \inf$ .

Набор условий в SC можно рассматривать как разделенный на два типа: первый тип состоит из условий гарантировать существование решений для OCP;другой тип включает в себя условия, обеспечивающие траекторию замкнутого контура фактически движется к решению . Это второй тип состояния естественно имеет сходство с условиями, требующими $W$ быть контрольной функцией Ляпунова. Сначала это может показать  $W$ удовлетворяет (SC5а) вместе со всеми другие условия - это такая же сложная задача, как и поиск управления функции Ляпунова. Тем не менее, отличительная черта подхода заключается в том, что (SC5а) требуется только выполнения на подмножестве $S$, которое дает свободу выбора $S$.Естественно возникает вопрос:между существованием проектных параметров, удовлетворяющих СЦ и управляемость системы на$Х_0$ . Управляемость системы, очевидно, необходима для достижения стабильности. Также выбор design parameters удовлетворение SC подразумевает стабильность, как показано. Объединив два вышеуказанных значения, управление  должно быть необходимым условием существования design parameters, удовлетворяющих СЦ. Замечание. Требование в SC1, чтобы набор $S$ закрыт необходимо гарантировать существование решения задачи оптимального управления обратной связи. Первая часть условия SC2 и условия SC3 тривиально удовлетворяются для обычной квадратичной задачи функция $L (x, u) = x^T Qx + u^T Ru,$ для $Q> 0$ и $R \geq 0$ и $W (x) = x^T Px$, при $P \geq 0$. Вторая часть SC2 о выпуклости «расширенной скорости набора »- это общеизвестное требование существования решения в OCP с интегральным стоимостным сроком. Учитывая H3,оно автоматически выполняется, если $L$ выпуклая и $f$ линейно зависима от $u$, или если $L$ не зависит от $u$.Последнее является следствием как $f (t, x, U (t))$, так и${l: l \geq L (t, x)}$ - выпуклые множества.

Такое состояние, как SC4 необходимо, чтобы гарантировать существование допустимого процесса в последовательности OCPs. Напомним, что в гипотезах H1 – H4 не было сделано предположения о целесообразности OCP. Эти гипотезы могут быть использованы в первоначальном тесте на адекватность метода, так как они включают только данные модели системы, которая, как правило,моделируется или имеет мало свободы для изменения. На более позднем этапе моделирования можно попытаться удовлетворить желаемым свойствам осуществимости и стабильности соответствующим выбором design parameters. Условие (SC5а) является ключевым требованием для установления существование «убывающей» ляпуновоподобной функциии, из этого следует асимптотическая устойчивость. Это может быть представленно как существованием элемента управления, который управляет состояниями к внутренним уровням наборов $W$ со скоростью $L$. В случае квадратичных функций $W$ множества уровней липоиды с центром в начале координат и вектор скорости должены указывать внутрь. Тем не менее, $W$ не нужно повторно ограничивать квадратичными функциями, и эта свобода может использоваться в наших интересах. Условие (SC5b) просто утверждает, что траектория связанный с $\tilde{u}$ не покидает множество $S$ сразу.

\section{КВАЗИБЕСКОНЕЧНЫЙ MРC}\label{}



\bigskip
